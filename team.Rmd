---
title: "team"
author: "Keven Lin & Adam Banwell"
date: 9/17/2021
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("tidyverse")
library(classdata)
data(choco)
```

# Searching for the Best Chocolates
### 1. How are the cocoa percent distributed? Create both a histogram and a boxplot and describe them. Donâ€™t forget to mention outliers, if there are any.
```{r}
cocoDist = choco$CocoaPercent
hist(cocoDist)
boxplot(cocoDist, horizontal = TRUE)
```

For the histogram and box plot above, there are outliers clearly seen outside the whiskers of the box plot.The whiskers start at about 64% and end about 80% so all points below or above those points respectfully are considered outliers.

### 2. How does the number of ratings depend on the country of bean origin? Draw a bar chart of the number of ratings by bean origin. [Hint: If your graph is too dense and the labels are not legible, show fewer bean origins.]

```{r}
cocoRating = choco %>%
  group_by(CountryBeanOrigin) %>% 
  summarise(avgRating = mean(Rating)) %>%
  head()

cocoRating %>%
  ggplot(aes(CountryBeanOrigin, avgRating)) +
  geom_col() +
  labs(title = "Average Bean Rating by Country") +
  geom_text(aes(label = signif(avgRating)))

```


According to the graph, regardless of being too dense, we find it obvious to see that the average rating is around 3 across all countries.

### 3. Do ratings depend on the cacao percentage of a chocolate bar? Create both numerical and graphical summaries, and explain. [Hint: Think about why the scatterplot is not a very good choice for visualization here.]
```{r}

# get choco with higest Coco percentage and rating
choco %>% filter(CocoaPercent == 100) %>% arrange(-Rating) %>% head(1)
# get average Rating for choco with 100% coco percentage
choco %>% group_by(CocoaPercent) %>% summarise(avgRating = mean(Rating)) %>% arrange(-CocoaPercent) %>% head(1)
# show bar chart with average coco percentage by rating
sortedData = choco %>% group_by(Rating) %>% summarise(Percentage = mean(CocoaPercent))
sortedData %>% ggplot(aes(Rating, Percentage)) + geom_col() + labs(title = "Average Percentage by Rating") + geom_text(aes(label = signif(Rating)))
  
```

Though both the numerical and graphical summary, we can see that the cocoa percentage does not play a significant role in determining the rating of the chocolate. 
An example of this in action is chocolate with highest coco percentage (100%) and the high rating, by it's coco percentage, only receive 3.5 out of 5. Compare to the average 4 point chocolate (out of 5 rating) has a coco percentage of slightly less of 75%. 
As a result we can safely conclude that coco percentage does not play a significant role in determining a chocolate's rating. 

### 4. How do different bean origins compare in terms of the flavor of chocolates? Are beans from some places better than the other? Create both numerical and graphical summaries, and explain.
```{r}
# get country that on average produce the best rated bean
choco %>% group_by(CountryBeanOrigin) %>% summarise(avgRating = mean(Rating)) %>% arrange(-avgRating) %>% head(1)
# get country that on average produce the worst rated bean
choco %>% group_by(CountryBeanOrigin) %>% summarise(avgRating = mean(Rating)) %>% arrange(avgRating) %>% head(1)

choco %>% group_by(CountryBeanOrigin) %>% summarise(bestRating = max(Rating), worstRating = min(Rating), avgRating = mean(Rating)) %>% arrange(-avgRating) 

# plot Best 10 Country With The Highest Average Rating
sortedData = choco %>% group_by(CountryBeanOrigin) %>% summarise(Rating = mean(Rating)) %>% arrange(-Rating) %>% head(10)
sortedData %>% ggplot(aes(CountryBeanOrigin, Rating)) + geom_col() + labs(title = "Best 10 Country With The Highest Average Rating") + coord_flip() + geom_text(aes(label = signif(Rating)))

#choco %>% mutate(numFlavors = rowSums(!is.na(select(., Characteristics1:Characteristics4))))
choco$numFlavor <- rowSums(!is.na(choco[8:11]))
choco %>% group_by(CountryBeanOrigin) %>% filter(numFlavor %in% 4) %>% head()
choco %>% ggplot(aes(CountryBeanOrigin, numFlavor)) + geom_col() + labs(title = "number of flavor by country") + coord_flip() + geom_text(aes(label = signif(numFlavor)))
choco %>% group_by(numFlavor) %>% summarise(avgRating = mean(Rating)) %>% head()


```

Through our analysis, we notice that there only 6 counties that are able to produce coco beans with 4 distinct characteristics out of 10 countries. We can see that the bean's Country of origin does play a role in determining the flavor (rating) of the beans. As the county with the average best rated beans are from Tobago and the average worst rated beans are from Puerto Rico. However, just because Puerto Rico has the worst average rating compare to the other countries, it does not mean Puerto Rico produces the worst beans. As there are still production faculties that can produce beans ranked 3.5. That is comparable to Sao Tome & Principle (the top 2nd Country by average rating). So at the end of the day we should be careful in grouping regions together within the same country as they can have wildly different results.   

### 5. If you work on this lab by yourself, brainstorm two analyses you would like to perform. If you work with a teammate, brainstorm at least three analyses with your teammate. Describe in plain language what comparisons are you making. Create suitable numerical and graphical summaries for your analyses. Describe the results.

1) Comparison of Company to Chocolate Rating, Does Company effect Rating?
```{r}
groupings = summarise(group_by(choco, Company), avgRating=mean(Rating))
groupings
ggplot(groupings, aes(x=Company, y=avgRating)) +
    geom_bar(stat='identity')
```

2) Comparison of ReviewDate to Chocolate Rating, Does ReviewDate effect Rating?
```{r}
groupings = summarise(group_by(choco, ReviewDate), avgRating=mean(Rating))
groupings
ggplot(groupings, aes(x=ReviewDate, y=avgRating)) +
    geom_bar(stat='identity')
```

3. Show me a graph of what was the average rating by year so we can get a good idea what was happening in the chocolate and cocoa market. 
```{r}
groupings = summarise(group_by(choco, SpecificBeanOrigin), avgRating=mean(Rating))
groupings
ggplot(groupings, aes(x=SpecificBeanOrigin, y=avgRating)) +
    geom_bar(stat='identity')
```
